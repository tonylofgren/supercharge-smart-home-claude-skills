# Climate Schedule Automation Template
# Generated by ha-yaml@aurora-smart-home v1.0.0
# https://github.com/tonylofgren/aurora-smart-home
#
# INSTRUCTIONS:
# 1. Replace climate entity with your thermostat
# 2. Adjust temperatures and times as needed
# 3. Add your person entities to the group.family below
# 4. Replace YOUR_WINDOW and YOUR_PHONE placeholders

# ============================================================
# REQUIRED GROUP FOR PRESENCE DETECTION
# ============================================================
# Add your person entities to track family presence
group:
  family:
    name: "Family"
    icon: mdi:account-group
    entities:
      - person.YOUR_NAME        # Replace with your person entity
      # - person.PARTNER_NAME   # Add more family members
      # - person.CHILD_NAME

# ============================================================
# REQUIRED HELPERS
# ============================================================
input_number:
  comfort_temp:
    name: "Comfort Temperature"
    min: 16
    max: 26
    step: 0.5
    unit_of_measurement: "°C"
    icon: mdi:thermometer
    initial: 21

  away_temp:
    name: "Away Temperature"
    min: 14
    max: 20
    step: 0.5
    unit_of_measurement: "°C"
    icon: mdi:thermometer-low
    initial: 17

  sleep_temp:
    name: "Sleep Temperature"
    min: 14
    max: 22
    step: 0.5
    unit_of_measurement: "°C"
    icon: mdi:bed
    initial: 18

input_boolean:
  climate_schedule_enabled:
    name: "Climate Schedule Enabled"
    icon: mdi:calendar-clock

# Optional: Use schedule helper for more control
schedule:
  climate_home_hours:
    name: "Home Hours"
    monday:
      - from: "06:30:00"
        to: "08:30:00"
      - from: "17:00:00"
        to: "22:30:00"
    tuesday:
      - from: "06:30:00"
        to: "08:30:00"
      - from: "17:00:00"
        to: "22:30:00"
    wednesday:
      - from: "06:30:00"
        to: "08:30:00"
      - from: "17:00:00"
        to: "22:30:00"
    thursday:
      - from: "06:30:00"
        to: "08:30:00"
      - from: "17:00:00"
        to: "22:30:00"
    friday:
      - from: "06:30:00"
        to: "08:30:00"
      - from: "17:00:00"
        to: "23:00:00"
    saturday:
      - from: "08:00:00"
        to: "23:30:00"
    sunday:
      - from: "08:00:00"
        to: "22:30:00"

automation:
  # Morning Warmup (Weekdays)
  - id: climate_morning_weekday
    alias: "Climate - Morning Weekday"
    trigger:
      - platform: time
        at: "06:00:00"
    condition:
      - condition: state
        entity_id: input_boolean.climate_schedule_enabled
        state: "on"
      - condition: time
        weekday:
          - mon
          - tue
          - wed
          - thu
          - fri
    action:
      - service: climate.set_temperature
        target:
          entity_id: climate.YOUR_THERMOSTAT  # Replace
        data:
          temperature: "{{ states('input_number.comfort_temp') | float }}"
          hvac_mode: heat

  # Morning Warmup (Weekend)
  - id: climate_morning_weekend
    alias: "Climate - Morning Weekend"
    trigger:
      - platform: time
        at: "07:30:00"
    condition:
      - condition: state
        entity_id: input_boolean.climate_schedule_enabled
        state: "on"
      - condition: time
        weekday:
          - sat
          - sun
    action:
      - service: climate.set_temperature
        target:
          entity_id: climate.YOUR_THERMOSTAT
        data:
          temperature: "{{ states('input_number.comfort_temp') | float }}"
          hvac_mode: heat

  # Daytime Setback (Weekdays)
  - id: climate_daytime_setback
    alias: "Climate - Daytime Setback"
    trigger:
      - platform: time
        at: "08:30:00"
    condition:
      - condition: state
        entity_id: input_boolean.climate_schedule_enabled
        state: "on"
      - condition: time
        weekday:
          - mon
          - tue
          - wed
          - thu
          - fri
      - condition: state
        entity_id: group.family
        state: "not_home"
    action:
      - service: climate.set_temperature
        target:
          entity_id: climate.YOUR_THERMOSTAT
        data:
          temperature: "{{ states('input_number.away_temp') | float }}"

  # Evening Comfort
  - id: climate_evening
    alias: "Climate - Evening Comfort"
    trigger:
      - platform: time
        at: "16:30:00"
    condition:
      - condition: state
        entity_id: input_boolean.climate_schedule_enabled
        state: "on"
    action:
      - service: climate.set_temperature
        target:
          entity_id: climate.YOUR_THERMOSTAT
        data:
          temperature: "{{ states('input_number.comfort_temp') | float }}"
          hvac_mode: heat

  # Night Setback
  - id: climate_night
    alias: "Climate - Night Setback"
    trigger:
      - platform: time
        at: "22:30:00"
    condition:
      - condition: state
        entity_id: input_boolean.climate_schedule_enabled
        state: "on"
    action:
      - service: climate.set_temperature
        target:
          entity_id: climate.YOUR_THERMOSTAT
        data:
          temperature: "{{ states('input_number.sleep_temp') | float }}"

  # Window Open Detection
  - id: climate_window_open
    alias: "Climate - Window Open"
    trigger:
      - platform: state
        entity_id: binary_sensor.YOUR_WINDOW  # Replace
        to: "on"
        for:
          minutes: 2
    action:
      - service: climate.set_hvac_mode
        target:
          entity_id: climate.YOUR_THERMOSTAT
        data:
          hvac_mode: "off"
      - service: notify.mobile_app_YOUR_PHONE  # Replace
        data:
          message: "Window open - climate paused"

  # Window Closed - Resume
  - id: climate_window_closed
    alias: "Climate - Window Closed"
    trigger:
      - platform: state
        entity_id: binary_sensor.YOUR_WINDOW
        to: "off"
        for:
          minutes: 1
    condition:
      - condition: state
        entity_id: input_boolean.climate_schedule_enabled
        state: "on"
    action:
      - service: climate.set_hvac_mode
        target:
          entity_id: climate.YOUR_THERMOSTAT
        data:
          hvac_mode: heat
