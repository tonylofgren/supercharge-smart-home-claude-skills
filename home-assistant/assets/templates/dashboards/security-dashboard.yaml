# Security Dashboard Template
# Doors, windows, motion, cameras, and alarm overview
#
# Customize entity_ids to match your setup
# Requires: mushroom cards (HACS)
#
# Generated by ha-yaml@aurora-smart-home
# https://github.com/tonylofgren/aurora-smart-home

title: Security
icon: mdi:shield-home
path: security
type: sections

sections:
  - type: grid
    title: Alarm Status
    cards:
      # Main alarm panel
      - type: alarm-panel
        entity: alarm_control_panel.home_alarm
        name: Home Alarm
        states:
          - arm_home
          - arm_away
          - arm_night

      # Quick arm/disarm chips
      - type: custom:mushroom-chips-card
        chips:
          - type: action
            tap_action:
              action: call-service
              service: alarm_control_panel.alarm_disarm
              target:
                entity_id: alarm_control_panel.home_alarm
              data:
                code: !secret alarm_code
            icon: mdi:shield-off
            content: Disarm

          - type: action
            tap_action:
              action: call-service
              service: alarm_control_panel.alarm_arm_home
              target:
                entity_id: alarm_control_panel.home_alarm
              data:
                code: !secret alarm_code
            icon: mdi:shield-home
            content: Arm Home

          - type: action
            tap_action:
              action: call-service
              service: alarm_control_panel.alarm_arm_away
              target:
                entity_id: alarm_control_panel.home_alarm
              data:
                code: !secret alarm_code
            icon: mdi:shield-lock
            content: Arm Away

  - type: grid
    title: Entry Points
    cards:
      # Doors
      - type: custom:mushroom-template-card
        primary: Front Door
        secondary: |
          {{ 'Open' if is_state('binary_sensor.front_door', 'on') else 'Closed' }}
        icon: |
          {{ 'mdi:door-open' if is_state('binary_sensor.front_door', 'on') else 'mdi:door-closed' }}
        icon_color: |
          {{ 'red' if is_state('binary_sensor.front_door', 'on') else 'green' }}
        entity: binary_sensor.front_door
        tap_action:
          action: more-info

      - type: custom:mushroom-template-card
        primary: Back Door
        secondary: |
          {{ 'Open' if is_state('binary_sensor.back_door', 'on') else 'Closed' }}
        icon: |
          {{ 'mdi:door-open' if is_state('binary_sensor.back_door', 'on') else 'mdi:door-closed' }}
        icon_color: |
          {{ 'red' if is_state('binary_sensor.back_door', 'on') else 'green' }}
        entity: binary_sensor.back_door
        tap_action:
          action: more-info

      - type: custom:mushroom-template-card
        primary: Garage Door
        secondary: |
          {{ states('cover.garage_door') | title }}
        icon: |
          {{ 'mdi:garage-open' if is_state('cover.garage_door', 'open') else 'mdi:garage' }}
        icon_color: |
          {{ 'red' if is_state('cover.garage_door', 'open') else 'green' }}
        entity: cover.garage_door
        tap_action:
          action: more-info

      # Door lock
      - type: custom:mushroom-lock-card
        entity: lock.front_door_lock
        name: Front Lock

  - type: grid
    title: Windows
    cards:
      - type: custom:mushroom-entity-card
        entity: binary_sensor.living_room_window
        name: Living Room
        icon: mdi:window-closed-variant
        icon_color: |
          {{ 'red' if is_state('binary_sensor.living_room_window', 'on') else 'green' }}

      - type: custom:mushroom-entity-card
        entity: binary_sensor.bedroom_window
        name: Bedroom
        icon: mdi:window-closed-variant
        icon_color: |
          {{ 'red' if is_state('binary_sensor.bedroom_window', 'on') else 'green' }}

      - type: custom:mushroom-entity-card
        entity: binary_sensor.kitchen_window
        name: Kitchen
        icon: mdi:window-closed-variant
        icon_color: |
          {{ 'red' if is_state('binary_sensor.kitchen_window', 'on') else 'green' }}

      - type: custom:mushroom-entity-card
        entity: binary_sensor.bathroom_window
        name: Bathroom
        icon: mdi:window-closed-variant
        icon_color: |
          {{ 'red' if is_state('binary_sensor.bathroom_window', 'on') else 'green' }}

  - type: grid
    title: Motion Sensors
    cards:
      - type: custom:mushroom-entity-card
        entity: binary_sensor.front_yard_motion
        name: Front Yard
        icon: mdi:motion-sensor
        icon_color: |
          {{ 'amber' if is_state('binary_sensor.front_yard_motion', 'on') else 'grey' }}

      - type: custom:mushroom-entity-card
        entity: binary_sensor.back_yard_motion
        name: Back Yard
        icon: mdi:motion-sensor
        icon_color: |
          {{ 'amber' if is_state('binary_sensor.back_yard_motion', 'on') else 'grey' }}

      - type: custom:mushroom-entity-card
        entity: binary_sensor.living_room_motion
        name: Living Room
        icon: mdi:motion-sensor
        icon_color: |
          {{ 'amber' if is_state('binary_sensor.living_room_motion', 'on') else 'grey' }}

      - type: custom:mushroom-entity-card
        entity: binary_sensor.hallway_motion
        name: Hallway
        icon: mdi:motion-sensor
        icon_color: |
          {{ 'amber' if is_state('binary_sensor.hallway_motion', 'on') else 'grey' }}

  - type: grid
    title: Cameras
    cards:
      - type: picture-entity
        entity: camera.front_door
        name: Front Door
        show_state: false
        camera_view: live
        tap_action:
          action: more-info

      - type: picture-entity
        entity: camera.back_yard
        name: Back Yard
        show_state: false
        camera_view: live
        tap_action:
          action: more-info

      - type: picture-entity
        entity: camera.garage
        name: Garage
        show_state: false
        camera_view: live
        tap_action:
          action: more-info

      - type: picture-entity
        entity: camera.driveway
        name: Driveway
        show_state: false
        camera_view: live
        tap_action:
          action: more-info

  - type: grid
    title: Security Summary
    cards:
      - type: custom:mushroom-template-card
        primary: All Entry Points
        secondary: |
          {% set doors = [
            states.binary_sensor.front_door,
            states.binary_sensor.back_door,
            states.binary_sensor.garage_door_sensor
          ] | selectattr('state', 'eq', 'on') | list %}
          {% set windows = [
            states.binary_sensor.living_room_window,
            states.binary_sensor.bedroom_window,
            states.binary_sensor.kitchen_window,
            states.binary_sensor.bathroom_window
          ] | selectattr('state', 'eq', 'on') | list %}
          {% if doors or windows %}
            {{ doors | length }} doors, {{ windows | length }} windows open
          {% else %}
            All secured
          {% endif %}
        icon: |
          {% set any_open = is_state('group.all_doors', 'on') or is_state('group.all_windows', 'on') %}
          {{ 'mdi:shield-alert' if any_open else 'mdi:shield-check' }}
        icon_color: |
          {% set any_open = is_state('group.all_doors', 'on') or is_state('group.all_windows', 'on') %}
          {{ 'red' if any_open else 'green' }}

      - type: custom:mushroom-entity-card
        entity: sensor.last_motion_location
        name: Last Motion
        icon: mdi:motion-sensor

      - type: custom:mushroom-entity-card
        entity: sensor.last_door_opened
        name: Last Door Opened
        icon: mdi:door

  - type: grid
    title: Recent Events
    cards:
      - type: logbook
        entities:
          - binary_sensor.front_door
          - binary_sensor.back_door
          - cover.garage_door
          - binary_sensor.front_yard_motion
          - alarm_control_panel.home_alarm
        hours_to_show: 24
        title: Security Log
